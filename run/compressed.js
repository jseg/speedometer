!function(){function e(){var e="ClockPanel",n=u("00"),t=a(e+"-hour");t.appendChild(n);var d=u("00"),i=a(e+"-minute");i.appendChild(d);var l=u("00"),o=a(e+"-second");o.appendChild(u(":")),o.appendChild(l);var r=a(e+" BottomPanel-content");r.appendChild(t),r.appendChild(u(":")),r.appendChild(i),r.appendChild(o);var p=a(e+"-label");p.appendChild(u("CLOCK"));var c=a("BottomPanel");return c.appendChild(p),c.appendChild(r),{element:c,update:function(){var e=new Date;n.nodeValue=C(e.getHours()),d.nodeValue=C(e.getMinutes()),l.nodeValue=C(e.getSeconds())}}}function n(e){var n=a("Tab ClockTab Button");n.appendChild(u("CLOCK"));var t=n.classList,d=i(n,function(){e(),t.add("selected")});return d.enable(),{element:n,deselect:function(){t.remove("selected")}}}function t(){var e=[],n=0;return{add:function(t){e.push(t),n+=32435},distance:function(){return n},reset:function(){e.splice(0)}}}function a(e){var n=document.createElement("div");return n.className=e,n}function d(){function n(){i(function(){setTimeout(function(){T.update(),m.update(),b.update(),n()},50)})}function d(e){h&&distances.add(e),C.setSpeed(e.coords.speed)}var i=window.requestAnimationFrame,u=window.cancelAnimationFrame;i||(i=window.mozRequestAnimationFrame,u=window.mozCancelAnimationFrame);var h=!1,f=t(),C=o(),v=p(function(){M.removeChild(M.firstChild),M.appendChild(m.element)},function(){M.removeChild(M.firstChild),M.appendChild(T.element)},function(){M.removeChild(M.firstChild),M.appendChild(b.element)}),m=s(),T=c(f),b=e(),g="MainPanel",M=a(g+"-panel");M.appendChild(T.element);var P=l(function(){m.reset(),T.reset(),f.reset()}),w=r(function(){h=!0,m.start()},function(){h=!1,m.stop()}),E=a(g+"-content");E.appendChild(C.element),E.appendChild(M),E.appendChild(v.element),E.appendChild(P),E.appendChild(w.element);var B=a(g);return B.appendChild(E),navigator.geolocation.watchPosition(d,function(e){console.log("error",e)},{enableHighAccuracy:!0}),n(),{element:B,resize:function(e,n){var t=e/320;370*t>n&&(t=n/370),B.style.transform="scale("+t+")"}}}function i(e,n){function t(){l.add("active"),clearTimeout(i),i=setTimeout(function(){n(),i=setTimeout(function(){l.remove("active")},150)},100)}function a(e){0===e.button&&(e.preventDefault(),o?o=!1:t())}function d(e){e.preventDefault(),o=!0,t()}var i,l=e.classList,o=!1;return{disable:function(){e.removeEventListener("touchstart",d),e.removeEventListener("mousedown",a)},enable:function(){e.addEventListener("mousedown",a),e.addEventListener("touchstart",d)}}}function l(e){var n=a("ResetButton Button");n.appendChild(u("RESET"));var t=i(n,e);return t.enable(),n}function o(){var e="SpeedLabel",n=u("00"),t=a(e+"-grey");t.appendChild(n);var d=u("-"),i=a(e+"-integerPart");i.appendChild(d);var l=u("-"),o=a(e+"-fractionalPart");o.appendChild(u(".")),o.appendChild(l);var r=a(e+"-unit");r.appendChild(u("KM/H"));var p=a(e+"-label");p.appendChild(u("SPEED"));var c=a(e+"-content");c.appendChild(t),c.appendChild(i),c.appendChild(o),c.appendChild(r);var h=a(e);return h.appendChild(p),h.appendChild(c),{element:h,setSpeed:function(e){var t,a,i;if(isFinite(e)){e=18*e/5,e=Math.min(999.99,e),t=String(Math.floor(e)),a=Math.floor(e%1*10);var o=t.length;i=3==o?"":2==o?"0":"00"}else t="-",a="-",i="--";d.nodeValue=t,l.nodeValue=a,n.nodeValue=i}}}function r(e,n){var t=!1,d=u("START"),l=a("StartStopButton Button");l.appendChild(d);var o=i(l,function(){t?(t=!1,d.nodeValue="START",n()):(t=!0,d.nodeValue="STOP",e())});return o.enable(),{element:l}}function p(e,t,d){var i=h(function(){l.deselect(),o.deselect(),t()}),l=f(function(){i.deselect(),o.deselect(),e()}),o=n(function(){i.deselect(),l.deselect(),d()}),r=a("Tabs");return r.appendChild(i.element),r.appendChild(l.element),r.appendChild(o.element),{element:r}}function u(e){return document.createTextNode(e)}function c(e){function n(){var n=e.distance();n=Math.min(999999,n);var t=String(n%1e3);1==t.length?t="00"+t:2==t.length&&(t="0"+t),r.nodeValue=t,l.nodeValue=Math.floor(n/1e3);var a,i=l.nodeValue.length;a=3==i?"":2==i?"0":"00",d.nodeValue=a}var t="TripDistancePanel",d=u("00"),i=a(t+"-grey");i.appendChild(d);var l=u("0"),o=a(t+"-integerPart");o.appendChild(i),o.appendChild(l);var r=u("000"),p=a(t+"-fractionalPart");p.appendChild(u(".")),p.appendChild(r);var c=a(t+"-unit");c.appendChild(u("KM"));var h=a(t+" BottomPanel-content");h.appendChild(o),h.appendChild(p),h.appendChild(c);var s=a(t+"-label");s.appendChild(u("TRIP DISTANCE"));var f=a("BottomPanel");return f.appendChild(s),f.appendChild(h),{element:f,reset:n,update:n}}function h(e){var n="TripDistanceTab",t=a(n+"-content Tab-content");t.appendChild(u("TRIP")),t.appendChild(document.createElement("br")),t.appendChild(u("DISTANCE"));var d=a(n+" Tab Button");d.appendChild(a(n+"-aligner Tab-aligner")),d.appendChild(t);var l=d.classList;l.add("selected");var o=i(d,function(){e(),l.add("selected")});return o.enable(),{element:d,deselect:function(){l.remove("selected")}}}function s(){var e="TripTimePanel",n=u("00"),t=a(e+"-hour");t.appendChild(n);var d=u("00"),i=a(e+"-minute");i.appendChild(d);var l=u("00"),o=a(e+"-second");o.appendChild(u(":")),o.appendChild(l);var r=a(e+" BottomPanel-content");r.appendChild(t),r.appendChild(u(":")),r.appendChild(i),r.appendChild(o);var p=a(e+"-label");p.appendChild(u("TRIP TIME"));var c=a("BottomPanel");c.appendChild(p),c.appendChild(r);var h=0,s=null,f=359999e3;return{element:c,reset:function(){h=0,null!==s&&(s=Date.now())},start:function(){s=Date.now()},stop:function(){h+=Date.now()-s,h=Math.min(h,f),s=null},update:function(){if(null!==s){var e=Date.now();h+=e-s,s=e}h=Math.min(h,f);var t=h/1e3;l.nodeValue=C(Math.floor(t%60));var a=t/60;d.nodeValue=C(Math.floor(a%60));var i=a/60;n.nodeValue=C(Math.floor(i))}}}function f(e){var n="TripTimeTab",t=a(n+"-content Tab-content");t.appendChild(u("TRIP")),t.appendChild(document.createElement("br")),t.appendChild(u("TIME"));var d=a(n+" Tab Button");d.appendChild(a(n+"-aligner Tab-aligner")),d.appendChild(t);var l=d.classList,o=i(d,function(){e(),l.add("selected")});return o.enable(),{element:d,deselect:function(){l.remove("selected")}}}function C(e){return e=String(e),1==e.length&&(e="0"+e),e}!function(){function e(){n.resize(innerWidth,innerHeight)}!function(){var e=document.createElement("style");e.innerHTML='@font-face {font-family: FreeMono;src: url(fonts/FreeMono.ttf);src: local("FreeMono"), url(fonts/FreeMono.ttf);font-weight: normal;}@font-face {font-family: FreeMono;src: url(fonts/FreeMonoBold.ttf);src: local("FreeMono Bold"), url(fonts/FreeMonoBold.ttf);font-weight: bold;}',document.head.appendChild(e)}();var n=d();document.body.appendChild(n.element),addEventListener("resize",e),e()}()}();