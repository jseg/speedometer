!function(){function e(){var e="ClockPanel",n=c("00"),t=d(e+"-hour");t.appendChild(n);var a=c("00"),i=d(e+"-minute");i.appendChild(a);var o=c("00"),l=d(e+"-second");l.appendChild(c(":")),l.appendChild(o);var r=d(e+" BottomPanel-content");r.appendChild(t),r.appendChild(c(":")),r.appendChild(i),r.appendChild(l);var p=d(e+"-label");p.appendChild(c("CLOCK"));var u=d("BottomPanel");return u.appendChild(p),u.appendChild(r),{element:u,update:function(){var e=new Date;n.nodeValue=v(e.getHours()),a.nodeValue=v(e.getMinutes()),o.nodeValue=v(e.getSeconds())}}}function n(e){var n=d("Tab ClockTab Button");n.appendChild(c("CLOCK"));var t=n.classList,a=o(n,function(){e(),t.add("selected")});return a.enable(),{element:n,deselect:function(){t.remove("selected")}}}function t(){var e,n=0;return{add:function(t){e&&(n+=a(e,t)),e=t},get:function(){return n},reset:function(){positions.splice(0)}}}function a(e,n){function t(e){return e*Math.PI/180}var a=e.coords,d=n.coords,i=t(a.latitude),o=t(a.longitude),l=t(d.latitude),r=t(d.longitude),p=6371e3,u=l-i,c=r-o,h=Math.sin(u/2),s=Math.sin(c/2),f=h*h+Math.cos(i)*Math.cos(l)*s*s,C=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),v=p*C;return v}function d(e){var n=document.createElement("div");return n.className=e,n}function i(){function n(){i(function(){setTimeout(function(){T.update(),m.update(),M.update(),n()},50)})}function a(e){c&&s.add(e),C.setSpeed(e.coords.speed)}var i=window.requestAnimationFrame,o=window.cancelAnimationFrame;i||(i=window.mozRequestAnimationFrame,o=window.mozCancelAnimationFrame);var c=!1,s=t(),C=r(),v=u(function(){b.removeChild(b.firstChild),b.appendChild(m.element)},function(){b.removeChild(b.firstChild),b.appendChild(T.element)},function(){b.removeChild(b.firstChild),b.appendChild(M.element)}),m=f(),T=h(s),M=e(),g="MainPanel",b=d(g+"-panel");b.appendChild(T.element);var P=l(function(){m.reset(),T.reset(),s.reset()}),w=p(function(){c=!0,m.start()},function(){c=!1,m.stop()}),E=d(g+"-content");E.appendChild(C.element),E.appendChild(b),E.appendChild(v.element),E.appendChild(P),E.appendChild(w.element);var B=d(g);B.appendChild(E),navigator.geolocation.watchPosition(a,function(e){console.log("error",e)},{enableHighAccuracy:!0}),n();var S=navigator.requestWakeLock;return S&&S("screen"),{element:B,resize:function(e,n){var t=e/320;370*t>n&&(t=n/370),B.style.transform="scale("+t+")"}}}function o(e,n){function t(){o.add("active"),clearTimeout(i),i=setTimeout(function(){n(),i=setTimeout(function(){o.remove("active")},150)},100)}function a(e){0===e.button&&(e.preventDefault(),l?l=!1:t())}function d(e){e.preventDefault(),l=!0,t()}var i,o=e.classList,l=!1;return{disable:function(){e.removeEventListener("touchstart",d),e.removeEventListener("mousedown",a)},enable:function(){e.addEventListener("mousedown",a),e.addEventListener("touchstart",d)}}}function l(e){var n=d("ResetButton Button");n.appendChild(c("RESET"));var t=o(n,e);return t.enable(),n}function r(){var e="SpeedLabel",n=c("00"),t=d(e+"-grey");t.appendChild(n);var a=c("-"),i=d(e+"-integerPart");i.appendChild(a);var o=c("-"),l=d(e+"-fractionalPart");l.appendChild(c(".")),l.appendChild(o);var r=d(e+"-unit");r.appendChild(c("KM/H"));var p=d(e+"-label");p.appendChild(c("SPEED"));var u=d(e+"-content");u.appendChild(t),u.appendChild(i),u.appendChild(l),u.appendChild(r);var h=d(e);return h.appendChild(p),h.appendChild(u),{element:h,setSpeed:function(e){var t,d,i;if(isFinite(e)){e=18*e/5,e=Math.min(999.99,e),t=String(Math.floor(e)),d=Math.floor(e%1*10);var l=t.length;i=3==l?"":2==l?"0":"00"}else t="-",d="-",i="--";a.nodeValue=t,o.nodeValue=d,n.nodeValue=i}}}function p(e,n){var t=!1,a=c("START"),i=d("StartStopButton Button");i.appendChild(a);var l=o(i,function(){t?(t=!1,a.nodeValue="START",n()):(t=!0,a.nodeValue="STOP",e())});return l.enable(),{element:i}}function u(e,t,a){var i=s(function(){o.deselect(),l.deselect(),t()}),o=C(function(){i.deselect(),l.deselect(),e()}),l=n(function(){i.deselect(),o.deselect(),a()}),r=d("Tabs");return r.appendChild(i.element),r.appendChild(o.element),r.appendChild(l.element),{element:r}}function c(e){return document.createTextNode(e)}function h(e){function n(){var n=e.get();n=Math.min(999999,Math.floor(n));var t=String(n%1e3);1==t.length?t="00"+t:2==t.length&&(t="0"+t),r.nodeValue=t,o.nodeValue=Math.floor(n/1e3);var d,i=o.nodeValue.length;d=3==i?"":2==i?"0":"00",a.nodeValue=d}var t="TripDistancePanel",a=c("00"),i=d(t+"-grey");i.appendChild(a);var o=c("0"),l=d(t+"-integerPart");l.appendChild(i),l.appendChild(o);var r=c("000"),p=d(t+"-fractionalPart");p.appendChild(c(".")),p.appendChild(r);var u=d(t+"-unit");u.appendChild(c("KM"));var h=d(t+" BottomPanel-content");h.appendChild(l),h.appendChild(p),h.appendChild(u);var s=d(t+"-label");s.appendChild(c("TRIP DISTANCE"));var f=d("BottomPanel");return f.appendChild(s),f.appendChild(h),{element:f,reset:n,update:n}}function s(e){var n="TripDistanceTab",t=d(n+"-content Tab-content");t.appendChild(c("TRIP")),t.appendChild(document.createElement("br")),t.appendChild(c("DISTANCE"));var a=d(n+" Tab Button");a.appendChild(d(n+"-aligner Tab-aligner")),a.appendChild(t);var i=a.classList;i.add("selected");var l=o(a,function(){e(),i.add("selected")});return l.enable(),{element:a,deselect:function(){i.remove("selected")}}}function f(){var e="TripTimePanel",n=c("00"),t=d(e+"-hour");t.appendChild(n);var a=c("00"),i=d(e+"-minute");i.appendChild(a);var o=c("00"),l=d(e+"-second");l.appendChild(c(":")),l.appendChild(o);var r=d(e+" BottomPanel-content");r.appendChild(t),r.appendChild(c(":")),r.appendChild(i),r.appendChild(l);var p=d(e+"-label");p.appendChild(c("TRIP TIME"));var u=d("BottomPanel");u.appendChild(p),u.appendChild(r);var h=0,s=null,f=359999e3;return{element:u,reset:function(){h=0,null!==s&&(s=Date.now())},start:function(){s=Date.now()},stop:function(){h+=Date.now()-s,h=Math.min(h,f),s=null},update:function(){if(null!==s){var e=Date.now();h+=e-s,s=e}h=Math.min(h,f);var t=h/1e3;o.nodeValue=v(Math.floor(t%60));var d=t/60;a.nodeValue=v(Math.floor(d%60));var i=d/60;n.nodeValue=v(Math.floor(i))}}}function C(e){var n="TripTimeTab",t=d(n+"-content Tab-content");t.appendChild(c("TRIP")),t.appendChild(document.createElement("br")),t.appendChild(c("TIME"));var a=d(n+" Tab Button");a.appendChild(d(n+"-aligner Tab-aligner")),a.appendChild(t);var i=a.classList,l=o(a,function(){e(),i.add("selected")});return l.enable(),{element:a,deselect:function(){i.remove("selected")}}}function v(e){return e=String(e),1==e.length&&(e="0"+e),e}!function(){function e(){n.resize(innerWidth,innerHeight)}!function(){var e=document.createElement("style");e.innerHTML='@font-face {font-family: FreeMono;src: url(fonts/FreeMono.ttf);src: local("FreeMono"), url(fonts/FreeMono.ttf);font-weight: normal;}@font-face {font-family: FreeMono;src: url(fonts/FreeMonoBold.ttf);src: local("FreeMono Bold"), url(fonts/FreeMonoBold.ttf);font-weight: bold;}',document.head.appendChild(e)}();var n=i();document.body.appendChild(n.element),addEventListener("resize",e),e()}()}();